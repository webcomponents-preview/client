@use 'sass:meta' as meta;
@use 'sass:selector' as selector;
@use '@/styles/utils' as utils;

// add some default styles from GitHub for the rendered readme for the time being
@include meta.load-css('github-markdown-css/github-markdown');

// a small example of basic markdown styling can be found in the nextcloud project:
// https://github.com/nextcloud/deck/blob/main/src/css/markdown.scss

// prettier-ignore
wcp-readme {
  ---wcp-readme-dark-border-color: var(--wcp-readme-dark-border-color, var(--wcp-color-grey-24));
  ---wcp-readme-dark-highlight-background: var(--wcp-readme-dark-highlight-background, var(--wcp-color-grey-17));

  ---wcp-readme-light-border-color: var(--wcp-readme-light-border-color, var(--wcp-color-grey-80));
  ---wcp-readme-light-highlight-background: var(--wcp-readme-light-highlight-background, var(--wcp-color-blue-93));
}

// as we do not have Shadow DOM, we can't rely on the :host selector, so
// to scope the styles we use the tag name of the component
wcp-readme {
  display: block;

  // override some of the github styles to blend in with the rest
  &.markdown-body {
    // first, reset some defaults, to be inheritted from the global scope
    background-color: inherit;
    color: inherit;
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;

    // as these are wrapped in our custom `wcp-readme-example` component,
    // we need to reset the spacing on the projected pre elements
    wcp-readme-example pre {
      background: 0;
      margin: 0;
      padding: 0;
    }

    // all non-previable code example shall receive the correct border radius
    > pre {
      border-radius: var(--wcp-border-radius);
    }

    table tr {
      background-color: transparent;
    }

    img {
      background: none;
    }

    // as hash routing may be used, we can't rely on the `:target` pseudo selector, thus we set a class
    .target {
      text-decoration: underline;
    }

    @include utils.color-scheme(false, parent) using ($color-scheme) {
      // prettier-ignore
      table td, table th, table tr,
      h1, h2, h3, h4, h5, h6 {
        border-color: var(---wcp-readme-#{$color-scheme}-border-color);
      }

      > pre,
      table tr:nth-child(2n) {
        background-color: var(---wcp-readme-#{$color-scheme}-highlight-background);
      }

      wcp-code pre {
        background-color: var(---wcp-readme-#{$color-scheme}-highlight-background);
      }
    }
  }
}
